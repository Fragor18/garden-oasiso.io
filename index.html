<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>OASIS ‚Äî Classic Style</title>
    <style>
        * { box-sizing: border-box; font-family: sans-serif; }
        body { margin: 0; background: #0a1a0a; color: white; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }

        /* –®–∞–ø–∫–∞ */
        .header { background: #111; padding: 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #2e7d32; }
        .score { font-size: 1.2rem; font-weight: bold; color: #4caf50; }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –≥—Ä—è–¥–æ–∫ */
        .garden { flex: 1; overflow-y: auto; padding: 10px; display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; align-content: start; }
        @media (min-width: 600px) { .garden { grid-template-columns: repeat(4, 1fr); } }

        .slot { aspect-ratio: 1/1.2; background: #1a1a1a; border: 2px dashed #333; border-radius: 15px; display: flex; flex-direction: column; align-items: center; justify-content: center; cursor: pointer; position: relative; }
        .slot.locked { background: #000; color: #444; }
        
        .plant { background: white; color: #333; width: 95%; height: 95%; border-radius: 12px; display: flex; flex-direction: column; align-items: center; justify-content: space-around; padding: 5px; position: relative; }
        .age { position: absolute; top: 2px; right: 5px; font-size: 9px; color: #888; }
        
        .bar { width: 80%; height: 5px; background: #eee; border-radius: 3px; overflow: hidden; }
        .fill { height: 100%; transition: 0.3s; }

        /* –†—ã–Ω–æ–∫ (—Ç–µ–ø–µ—Ä—å –≤–Ω–∏–∑—É –∏–ª–∏ –ø–æ –∫–Ω–æ–ø–∫–µ) */
        .market-btn { background: #2e7d32; color: white; border: none; padding: 10px; border-radius: 5px; cursor: pointer; }
        .market-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 1000; display: none; flex-direction: column; align-items: center; padding-top: 50px; }
        .market-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; width: 90%; max-width: 400px; }
        
        .m-item { background: white; color: #333; padding: 10px; border-radius: 10px; text-align: center; }
        .m-item.empty { background: #222; color: #444; display: flex; align-items: center; justify-content: center; height: 100px; }
        
        /* –ù–∏–∂–Ω—è—è –ø–∞–Ω–µ–ª—å */
        .toolbar { background: #111; padding: 10px; display: flex; justify-content: center; gap: 15px; border-top: 2px solid #2e7d32; }
        .tool { font-size: 1.5rem; padding: 10px; background: #222; border-radius: 10px; cursor: pointer; border: 2px solid transparent; }
        .tool.active { border-color: #4caf50; background: #333; }

        .btn-buy { background: #2e7d32; color: white; border: none; padding: 5px; width: 100%; border-radius: 5px; margin-top: 5px; font-size: 10px; }
        .cheat { position: fixed; top: 10px; right: 10px; opacity: 0.3; }
    </style>
</head>
<body>

    <div class="header">
        <div class="score" id="score">üí∞ 150</div>
        <button class="market-btn" onclick="toggleMarket(true)">üõí –ú–ê–ì–ê–ó–ò–ù</button>
        <div id="mTimer" style="font-size: 10px;">05:00</div>
    </div>

    <div class="garden" id="garden"></div>

    <div class="toolbar">
        <div class="tool active" id="t-water" onclick="setTool('water')">üíß</div>
        <div class="tool" id="t-food" onclick="setTool('food')">üß™</div>
        <div class="tool" id="t-trash" onclick="setTool('trash')">üóëÔ∏è</div>
    </div>

    <div class="market-overlay" id="marketOverlay">
        <h2 style="margin-bottom: 20px;">–ü–†–ò–õ–ê–í–û–ö</h2>
        <div class="market-grid" id="marketGrid"></div>
        <button class="market-btn" style="margin-top: 30px; background: #7d2e2e;" onclick="toggleMarket(false)">–ó–ê–ö–†–´–¢–¨</button>
    </div>

    <button class="cheat" onclick="gameData.score += 100000; updateUI();">.</button>

    <script>
        const FLORA = [
            { id: 0, n: '–¢—Ä–∞–≤–∞', i: 'üå±', inc: 1, c: 20, r: 0.9 },
            { id: 1, n: '–†–æ–º–∞—à–∫–∞', i: 'üåº', inc: 3, c: 60, r: 0.8 },
            { id: 2, n: '–ö–∞–∫—Ç—É—Å', i: 'üåµ', inc: 10, c: 200, r: 0.7 },
            { id: 3, n: '–¢—é–ª—å–ø–∞–Ω', i: 'üå∑', inc: 25, c: 600, r: 0.6 },
            { id: 4, n: '–ü–æ–¥—Å–æ–ª–Ω—É—Ö', i: 'üåª', inc: 50, c: 1500, r: 0.5 },
            { id: 5, n: '–†–æ–∑–∞', i: 'üåπ', inc: 100, c: 4000, r: 0.4 },
            { id: 6, n: '–ü–∞–ª—å–º–∞', i: 'üå¥', inc: 250, c: 12000, r: 0.3 },
            { id: 7, n: '–ë–∞–º–±—É–∫', i: 'üéã', inc: 600, c: 35000, r: 0.2 },
            { id: 8, n: '–ï–ª—å', i: 'üå≤', inc: 1500, c: 100000, r: 0.15 },
            { id: 9, n: '–õ–∏–∞–Ω–∞', i: 'üåø', inc: 3000, c: 250000, r: 0.1 },
            { id: 10, n: '–ú—É—Ö–æ–ª–æ–≤–∫–∞', i: 'ü™¥', inc: 7000, c: 600000, r: 0.08 },
            { id: 11, n: '–ö–ª–µ–Ω', i: 'üçÅ', inc: 15000, c: 1500000, r: 0.05 },
            { id: 12, n: '–í–∏—à–Ω—è', i: 'üçí', inc: 35000, c: 4000000, r: 0.04 },
            { id: 13, n: '–ì—Ä–∏–±', i: 'üçÑ', inc: 80000, c: 10000000, r: 0.03 },
            { id: 14, n: '–û—Ä–µ—Ö', i: 'üå∞', inc: 150000, c: 25000000, r: 0.02 },
            { id: 15, n: '–õ–æ—Ç–æ—Å', i: 'ü™∑', inc: 300000, c: 60000000, r: 0.01 },
            { id: 16, n: '–ê–Ω–∞–Ω–∞—Å', i: 'üçç', inc: 700000, c: 150000000, r: 0.01 },
            { id: 17, n: '–ú–∞–Ω–≥–æ', i: 'ü•≠', inc: 1500000, c: 400000000, r: 0.008 },
            { id: 18, n: '–ê—Ä–±—É–∑', i: 'üçâ', inc: 4000000, c: 900000000, r: 0.005 },
            { id: 19, n: '–ö–ª–µ–≤–µ—Ä', i: 'üçÄ', inc: 10000000, c: 2000000000, r: 0.003 },
            { id: 20, n: '–î—Ä–∞–∫–æ–Ω', i: 'üêâ', inc: 50000000, c: 8000000000, r: 0.001 }
        ];

        let gameData = { score: 150, slots: 3, garden: new Array(16).fill(null), inventory: [0, 0] };
        let marketItems = [];
        let marketTimer = 300;
        let currentTool = 'water';

        function updateUI() {
            document.getElementById('score').innerText = 'üí∞ ' + Math.floor(gameData.score);
            renderGarden();
        }

        function toggleMarket(show) {
            document.getElementById('marketOverlay').style.display = show ? 'flex' : 'none';
        }

        function setTool(t) {
            currentTool = t;
            document.querySelectorAll('.tool').forEach(el => el.classList.remove('active'));
            document.getElementById('t-'+t).classList.add('active');
        }

        function refreshMarket() {
            marketItems = [];
            for(let i=0; i<6; i++) {
                let p = FLORA[Math.floor(Math.random() * FLORA.length)];
                marketItems.push(Math.random() < p.r ? p : null);
            }
            renderMarket();
        }

        function renderMarket() {
            const grid = document.getElementById('marketGrid');
            grid.innerHTML = marketItems.map((p, idx) => {
                if(!p) return `<div class="m-item empty">–ü–£–°–¢–û</div>`;
                return `
                <div class="m-item">
                    <div style="font-size:1.5rem">${p.i}</div>
                    <div style="font-size:10px; font-weight:bold">${p.n}</div>
                    <button class="btn-buy" onclick="buySeed(${idx})">üí∞ ${p.c}</button>
                </div>`;
            }).join('');
        }

        function buySeed(mIdx) {
            const p = marketItems[mIdx];
            if(gameData.score >= p.c) {
                gameData.score -= p.c;
                gameData.inventory.push(p.id);
                marketItems[mIdx] = null;
                renderMarket();
                updateUI();
            }
        }

        function renderGarden() {
            const g = document.getElementById('garden');
            g.innerHTML = '';
            for(let i=0; i<16; i++) {
                let p = gameData.garden[i];
                let locked = i >= gameData.slots;
                let div = document.createElement('div');
                div.className = 'slot' + (locked ? ' locked' : '');

                if(locked) {
                    let cost = gameData.slots * 1500;
                    div.innerHTML = `üîí<br><small>${cost}</small>`;
                    div.onclick = () => { if(gameData.score >= cost) { gameData.score -= cost; gameData.slots++; updateUI(); } };
                } else if(!p) {
                    div.innerHTML = '‚ûï';
                    div.onclick = () => openPlantMenu(i);
                } else {
                    let info = FLORA[p.id];
                    div.innerHTML = `
                        <div class="plant">
                            <span class="age">${Math.floor(p.age)}/50</span>
                            <div style="font-size:2.5rem">${info.i}</div>
                            <div class="bar"><div class="fill" style="width:${p.w}%; background:#3b82f6"></div></div>
                            <div class="bar"><div class="fill" style="width:${p.h}%; background:#22c55e"></div></div>
                        </div>`;
                    div.onclick = () => {
                        if(currentTool === 'water') p.w = Math.min(p.w + 40, 100);
                        if(currentTool === 'food') p.h = Math.min(p.h + 30, 100);
                        if(currentTool === 'trash') gameData.garden[i] = null;
                        updateUI();
                    };
                }
                g.appendChild(div);
            }
        }

        function openPlantMenu(sIdx) {
            if(gameData.inventory.length === 0) return alert("–°–Ω–∞—á–∞–ª–∞ –∫—É–ø–∏ —Å–µ–º–µ–Ω–∞!");
            let h = '<h3 style="color:white">–ü–û–°–ê–î–ò–¢–¨:</h3><div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; width:100%">';
            gameData.inventory.forEach((id, iIdx) => {
                let p = FLORA[id];
                h += `<button class="m-item" style="border:none; cursor:pointer" onclick="plantSeed(${sIdx}, ${iIdx})">${p.i} ${p.n}</button>`;
            });
            h += '</div>';
            document.getElementById('marketContent').innerHTML = h;
            toggleModal(true);
        }

        // –ü–æ—Å–∞–¥–∫–∞
        window.plantSeed = (sIdx, iIdx) => {
            let id = gameData.inventory.splice(iIdx, 1)[0];
            gameData.garden[sIdx] = { id, w: 100, h: 100, age: 0 };
            toggleModal(false);
            updateUI();
        };

        function toggleModal(show) {
            const m = document.getElementById('modalBg');
            if(!m) {
                const bg = document.createElement('div');
                bg.id = 'modalBg';
                bg.className = 'market-overlay';
                bg.style.display = 'flex';
                bg.innerHTML = `<div id="marketContent" style="width:90%; max-width:350px"></div><button class="market-btn" style="margin-top:20px" onclick="this.parentElement.style.display='none'">–û–¢–ú–ï–ù–ê</button>`;
                document.body.appendChild(bg);
            } else {
                m.style.display = show ? 'flex' : 'none';
            }
        }

        setInterval(() => {
            marketTimer--;
            if(marketTimer <= 0) { marketTimer = 300; refreshMarket(); }
            
            let m = Math.floor(marketTimer / 60), s = marketTimer % 60;
            document.getElementById('mTimer').innerText = `–†–´–ù–û–ö –ß–ï–†–ï–ó: ${m}:${s<10?'0'+s:s}`;

            gameData.garden.forEach((p, i) => {
                if(p) {
                    p.w = Math.max(0, p.w - 0.7);
                    p.age += 0.1;
                    if(p.w < 20) p.h -= 0.6;
                    if(p.age >= 50 || p.h <= 0) gameData.garden[i] = null;
                    else if(p.h > 40) gameData.score += FLORA[p.id].inc;
                }
            });
            updateUI();
        }, 1000);

        refreshMarket();
        updateUI();
    </script>
</body>
</html>

